(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74121,e=>{"use strict";async function t(e){let t=await fetch("".concat("https://www.maxicourses.fr/maxicoursesapp/api/scrape2.php","?url=").concat(encodeURIComponent(e))),r=await t.json();if(!r.ok)throw Error(r.error||"scrape failed");return r}e.s(["fetchPrice",()=>t])},18888,e=>{"use strict";e.s(["default",()=>s]);var t=e.i(65830),r=e.i(6943),l=e.i(74121);let n="mc_items_v1",i=e=>e.toLocaleString("fr-FR",{style:"currency",currency:"EUR"});function s(){let[e,s]=(0,r.useState)(()=>{try{return JSON.parse(localStorage.getItem(n)||"[]")}catch(e){return[]}});(0,r.useEffect)(()=>{localStorage.setItem(n,JSON.stringify(e))},[e]);let c=(0,r.useMemo)(()=>{let t=0,r=0,l=0;for(let n of e){let e=null!=n.priceA?n.priceA*(n.qty||0):0,i=null!=n.priceB?n.priceB*(n.qty||0):0;t+=e,r+=i,null!=n.priceA&&null!=n.priceB&&(l+=Math.abs(n.priceA-n.priceB)*(n.qty||0))}return{A:t,B:r,eco:l,winner:t===r?"Égalité":t<r?"Colonne A":"Colonne B"}},[e]);function a(t,r,l){s(e.map(e=>e.id===t?{...e,[r]:l}:e))}async function d(t){if(t.urlA)try{let r=await (0,l.fetchPrice)(t.urlA);s(e.map(e=>e.id===t.id?{...e,name:e.name.startsWith("Produit ")?r.title:e.name,priceA:r.price}:e))}catch(e){}}async function o(t){if(t.urlB)try{let r=await (0,l.fetchPrice)(t.urlB);s(e.map(e=>e.id===t.id?{...e,name:e.name.startsWith("Produit ")?r.title:e.name,priceB:r.price}:e))}catch(e){}}return(0,t.jsxs)("main",{className:"mx-auto max-w-5xl p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Comparaison live"}),(0,t.jsx)("p",{className:"text-sm text-neutral-600 mt-1",children:"Colonne A = autre enseigne (prix manuel si besoin). Colonne B = Monoprix (auto OK)."}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:function(){let t=e.length+1;s([...e,{id:String(Date.now()),name:"Produit ".concat(t),qty:1,urlA:"",urlB:""}])},className:"px-4 py-2 bg-black text-white rounded text-sm",children:"Ajouter un produit"})}),(0,t.jsxs)("table",{className:"w-full text-sm mt-4",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left",children:"Produit"}),(0,t.jsx)("th",{children:"Qté"}),(0,t.jsx)("th",{className:"text-left",children:"URL A"}),(0,t.jsx)("th",{className:"text-left",children:"URL B (Monoprix)"}),(0,t.jsx)("th",{children:"€/A"}),(0,t.jsx)("th",{children:"€/B"}),(0,t.jsx)("th",{children:"Économie"}),(0,t.jsx)("th",{})]})}),(0,t.jsxs)("tbody",{children:[e.map(r=>{let l=null==r.priceA||null==r.priceB?null:r.priceA<r.priceB?"A":r.priceB<r.priceA?"B":null,n=null!=r.priceA&&null!=r.priceB?Math.abs(r.priceA-r.priceB)*(r.qty||0):0;return(0,t.jsxs)("tr",{className:"border-t align-top",children:[(0,t.jsx)("td",{className:"py-2",children:(0,t.jsx)("input",{value:r.name,onChange:e=>a(r.id,"name",e.target.value),className:"border rounded px-2 py-1 w-48"})}),(0,t.jsx)("td",{className:"py-2 text-center",children:(0,t.jsx)("input",{type:"number",min:0,value:r.qty,onChange:e=>a(r.id,"qty",Number(e.target.value)||0),className:"border rounded px-2 py-1 w-20 text-right"})}),(0,t.jsx)("td",{className:"py-2",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{value:r.urlA,onChange:e=>a(r.id,"urlA",e.target.value),placeholder:"URL produit enseigne A",className:"border rounded px-2 py-1 w-full"}),(0,t.jsx)("button",{onClick:()=>d(r),className:"px-2 py-1 border rounded",children:"Lire prix"})]})}),(0,t.jsx)("td",{className:"py-2",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{value:r.urlB,onChange:e=>a(r.id,"urlB",e.target.value),placeholder:"https://courses.monoprix.fr/...",className:"border rounded px-2 py-1 w-full"}),(0,t.jsx)("button",{onClick:()=>o(r),className:"px-2 py-1 border rounded",children:"Lire prix"})]})}),(0,t.jsxs)("td",{className:"py-2 text-center ".concat("A"===l?"bg-green-50 font-semibold":""),children:[(0,t.jsx)("div",{children:null!=r.priceA?r.priceA.toFixed(2):"-"}),(0,t.jsx)("input",{placeholder:"saisir €",onBlur:t=>(function(t,r){let l=Number.parseFloat(r.replace(",","."));Number.isFinite(l)&&s(e.map(e=>e.id===t?{...e,priceA:l}:e))})(r.id,t.currentTarget.value),className:"mt-1 border rounded px-2 py-1 w-24 text-right"}),"A"===l&&(0,t.jsx)("div",{className:"text-xs text-green-700",children:"moins cher"})]}),(0,t.jsxs)("td",{className:"py-2 text-center ".concat("B"===l?"bg-green-50 font-semibold":""),children:[(0,t.jsx)("div",{children:null!=r.priceB?r.priceB.toFixed(2):"-"}),(0,t.jsx)("input",{placeholder:"saisir €",onBlur:t=>(function(t,r){let l=Number.parseFloat(r.replace(",","."));Number.isFinite(l)&&s(e.map(e=>e.id===t?{...e,priceB:l}:e))})(r.id,t.currentTarget.value),className:"mt-1 border rounded px-2 py-1 w-24 text-right"}),"B"===l&&(0,t.jsx)("div",{className:"text-xs text-green-700",children:"moins cher"})]}),(0,t.jsx)("td",{className:"py-2 text-center",children:n?i(n):"-"}),(0,t.jsx)("td",{className:"py-2 text-center",children:(0,t.jsx)("button",{onClick:()=>{var t;return t=r.id,void s(e.filter(e=>e.id!==t))},className:"px-2 py-1 border rounded",children:"Suppr"})})]},r.id)}),0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:8,className:"py-6 text-neutral-500",children:"Aucun produit. Cliquez “Ajouter un produit”."})})]}),(0,t.jsx)("tfoot",{children:(0,t.jsxs)("tr",{className:"border-t font-semibold",children:[(0,t.jsx)("td",{children:"Total"}),(0,t.jsx)("td",{}),(0,t.jsx)("td",{}),(0,t.jsx)("td",{}),(0,t.jsx)("td",{className:"text-center",children:i(c.A)}),(0,t.jsx)("td",{className:"text-center",children:i(c.B)}),(0,t.jsx)("td",{className:"text-center",children:i(c.eco)}),(0,t.jsx)("td",{className:"text-center",children:c.winner})]})})]})]})}}]);